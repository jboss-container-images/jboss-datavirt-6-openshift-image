schema_version: 1

name: "jboss-datavirt-6/datavirt64-openshift"
description: "Red Hat JBoss Data Virtualization 6 for OpenShift container image"
version: "1.3"
from: "jboss/openjdk18-rhel7:1.1"
labels:
    - name: "com.redhat.component"
      value: "jboss-datavirt-6-datavirt64-openshift-container"
    - name: "org.jboss.product"
      value: "datavirt"
    - name: "org.jboss.product.version"
      value: "6.4.3.GA"
    - name: "org.jboss.product.datavirt.version"
      value: "6.4.3.GA"
    - name: "io.k8s.description"
      value: "Platform for running JBoss Data Virtualization"
    - name: "io.k8s.display-name"
      value: "JBoss Data Virtualization 6.4"
    - name: "io.openshift.expose-services"
      value: "8080:http"
    - name: "io.openshift.tags"
      value: "builder,datavirt,datavirt6"
    - name: "io.openshift.s2i.scripts-url"
      value: "image:///usr/local/s2i"
    - name: "org.jboss.deployments-dir"
      value: "/opt/eap/standalone/deployments"
    - name: "com.redhat.deployments-dir"
      value: "/opt/eap/standalone/deployments"
    - name: "com.redhat.dev-mode"
      value: "DEBUG:true"
      description: "Environment variable used to enable development mode (debugging).  A value of true will enable development mode."
    - name: "com.redhat.dev-mode.port"
      value: "DEBUG_PORT:8787"
      description: "Environment variable used to specify the debug port.  If not set, the default EAP debug port will be used (8787).  Only applicable when development mode is enabled."
      
envs:
    - name: "JBOSS_PRODUCT"
      value: "datavirt"
    - name: "JBOSS_DATAVIRT_VERSION"
      value: "6.4.3.GA"
    - name: "PRODUCT_VERSION"
      value: "6.4.3.GA"
    - name: "STI_BUILDER"
      value: "jee"
    - name: "LAUNCH_JBOSS_IN_BACKGROUND"
      value: "true"
    - name: "JBOSS_HOME"
      value: "/opt/eap"
    - name: "DEBUG"
      example: "true"
      description: "Specify true to enable development mode (debugging)."
    - name: "DEBUG_PORT"
      example: "8787"
      description: "Specify the port to use for debugging. If not set, the default EAP debug port will be used (8787).  Only applicable when development mode is enabled."      
    - name: "DEFAULT_ADMIN_USERNAME"
      value: "eapadmin"
    - name: "OPENSHIFT_KUBE_PING_NAMESPACE"
      example: "myproject" 
    - name: "LAUNCH_JBOSS_IN_BACKGROUND"
      value: "true"
    - name: "JBOSS_PRODUCT"
      value: "eap"
    - name: "JBOSS_EAP_VERSION"
      value: "6.4.20.GA"
    - name: "PRODUCT_VERSION"
      value: "6.4.20.GA"
    - name: "JBOSS_HOME"
      value: "/opt/eap"
    - name: "DEBUG"
      example: "true"
      description: "Specify true to enable development mode (debugging)."
    - name: "DEBUG_PORT"
      example: "8787"
      description: "Specify the port to use for debugging. If not set, the default EAP debug port will be used (8787).  Only applicable when development mode is enabled."
      description: "Clustering project namespace."
    - name: "OPENSHIFT_KUBE_PING_LABELS"
      example: "application=datavirt"
      description: "Clustering labels selector."
    - name: SCRIPT_DEBUG
      description: If set to true, ensurses that the bash scripts are executed with the -x option, printing the commands and their arguments as they are executed.
      example: "true"
    - name: CUSTOM_INSTALL_DIRECTORIES
      description: A list of comma-separated directories used for installation and configuration of artifacts for the image during the S2I process.
      example: "custom,shared"
    - name: "VDB_DIRS"
      example: "src/vdbs"
      description: "Comma-delimited list of directories containing VDB files targeted for deployment"
ports:
    - value: 8080
    - value: 8787
      expose: false
    - value: 8443
    - value: 31000
    - value: 35432
    - value: 31443
modules:
      repositories:
        - name: cct_module
          git:
               url: https://github.com/jboss-openshift/cct_module.git
               ref: master
        - name: jboss-jdv-modules
          git:
               url: https://github.com/jboss-container-images/jboss-jdv-modules.git
               ref: master
      install:
          - name: dynamic-resources
          - name: s2i-common
          - name: java-alternatives
          - name: os-eap64-openshift
          - name: os-eap-s2i
          - name: os-java-jolokia
          - name: jolokia
          - name: os-eap64-openshift
          - name: os-eap64-modules
          - name: os-eap64-ping
          - name: os-java-run
          - name: os-eap-launch
          - name: os-eap64-launch
          - name: jboss.eap-logging.ext
          - name: os-eap-probes
          - name: jboss-maven
          - name: os-eap-db-drivers
          - name: os-eap-sso
          - name: os-eap64-sso
          - name: os-eap-deployment-scanner
          - name: os-eap-extensions
          - name: jboss.jdv.os-datavirt-s2i
          - name: openshift-layer
          - name: openshift-passwd
          - name: jboss.jdv.os-datavirt
          - name: jboss.jdv.os-datavirt64
          - name: os-logging
artifacts:
    - path: jboss-eap-6.4.0.zip
      description: "Artifact is available on Customer Portal: https://access.redhat.com/jbossnetwork/restricted/softwareDetail.html?softwareId=37393&product=appplatform&version=6.4&downloadType=distributions"
      md5: 9a5d37631919a111ddf42ceda1a9f0b5
    - path: jboss-eap-6.4.9-patch.zip
      md5: fdc6cd3bf51ba2714b98de2923266537
    - path: jboss-eap-6.4.19-patch.zip
      sha256: 02d46374ef3fa226655a29216fa9d95b379c1037a4dc3c5d1b23869495ff6ebc
    - path: jboss-eap-6.4.20-patch.zip
      md5: 04ff7fab93e19c96011d2a86b5769f07
    - path: jboss-dv-6.4.0-installer.jar
      md5: 5a9c1a24917c6194b6f93e92fc5e0fd8
    - path: jboss-dv-6.4.3-patch.jar
      md5: 36baf0e1c52eae3c9914dce850974fc6 
    - path: jboss-datagrid-7.1.2-eap-modules-remote-java-client.zip
      md5: dc43e49cddeb1d4ddefdd99e577e4b43
      description: "Red Hat JBoss Data Grid 7.1.2 Remote Client"
run:
      user: 185
      cmd:
          - "/opt/eap/bin/openshift-launch.sh"
osbs:
      repository:
            name: containers/jboss-datavirt-6
            branch: jb-datavirt-6.4-openshift-rhel-7
